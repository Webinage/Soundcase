"use strict";(self.webpackChunkdocs_2=self.webpackChunkdocs_2||[]).push([[9283],{9617:function(t,e,n){n.r(e),n.d(e,{default:function(){return f}});var i=n(1721),o=n(1262),u=n(6698),a=n(7294),r=n(5462),s=function(t){function e(e){var n;n=t.call(this,e)||this;var i=new r.Z.AudioEngine,o=i.createSoundPlayer("soundPlayer",{timba:{path:"../../static/sounds/timba.mp3",type:"loop",volume:1}}),u=i.createEffect("Delay"),a=i.createChannelStrip("effects",[u]);return o.connect(a),n.state={audioEngine:i,soundPlayer:o,effect:u,muted:"off",delayTime:3,feedback:2,reverse:"off",dryWetRatio:.5,effectsChannel:a},n}(0,i.Z)(e,t);var n=e.prototype;return n.stop=function(){this.state.soundPlayer.stopSound("timba")},n.play=function(){this.state.soundPlayer.playSound("timba")},n.updateState=function(t,e){this.setState((function(n){var i;return(i={})[t]=e,i}))},n.handleDelayTimeInputChange=function(t){this.updateState("delayTime",t.target.value),this.state.effect.setDelayTime(t.target.value)},n.handleFeedbackInputChange=function(t){this.updateState("feedback",t.target.value),this.state.effect.setFeedback(t.target.value)},n.handleDryWetRatioInputChange=function(t){this.updateState("dryWetRatio",t.target.value),this.state.effect.setDryWetRatio(t.target.value)},n.handleMutedInputChange=function(t){this.updateState("muted",t.target.value),this.state.effect.muted="on"===t.target.value},n.render=function(){var t=this;return a.createElement("div",null,a.createElement("h2",null,"Delay"),a.createElement("pre",null,a.createElement("code",null,"\n            const audioEngine = new AE.AudioEngine()\n            const soundPlayer = audioEngine.createSoundPlayer('soundPlayer', {\n              timba: {\n                path: '../../static/sounds/timba.mp3',\n                type: 'loop',\n                volume: 1,\n              }\n            })\n\n            const effectsChannel = audioEngine.createChannelStrip('effects', [\n              audioEngine.createEffect('Delay')\n            ])\n\n            soundPlayer.connect(effectsChannel)\n\n            this.state.soundPlayer.playSound('timba')\n            ")),a.createElement("button",{onClick:function(){return t.stop()}},"Stop"),a.createElement("button",{onClick:function(){return t.play()}},"Play"),a.createElement("div",null,a.createElement("label",{htmlFor:"delayTime"},"Delay time : ",this.state.delayTime),a.createElement("br",null),a.createElement("input",{name:"delayTime",type:"range",min:"0",max:"5",step:"0.01",value:this.state.delayTime,onChange:function(e){return t.handleDelayTimeInputChange(e)}})),a.createElement("div",null,a.createElement("label",{htmlFor:"feedback"},"Feedback : ",this.state.feedback),a.createElement("br",null),a.createElement("input",{name:"feedback",type:"range",min:"0",max:"1",step:"0.01",value:this.state.feedback,onChange:function(e){return t.handleFeedbackInputChange(e)}})),a.createElement("div",null,a.createElement("label",{htmlFor:"dryWetRatio"},"Dry/Wet ratio : ",this.state.dryWetRatio),a.createElement("br",null),a.createElement("input",{name:"dryWetRatio",type:"range",min:"0",max:"1",step:"0.01",value:this.state.dryWetRatio,onChange:function(e){return t.handleDryWetRatioInputChange(e)}})),a.createElement("div",null,a.createElement("label",{htmlFor:"muted"},"Muted : ",this.state.muted),a.createElement("input",{name:"muted",type:"checkbox",value:this.state.muted,onChange:function(e){return t.handleReverseInputChange(e)}})))},e}(a.Component),c=function(t){function e(e){var n;n=t.call(this,e)||this;var i=new r.Z.AudioEngine,o=i.createEffect("Distortion"),u=i.createChannelStrip("effects",[o]),a=i.createSoundPlayer("soundPlayer",{guitar:{path:"../../static/sounds/guitar.mp3",type:"loop",volume:1}});return a.connect(u),n.state={audioEngine:i,soundPlayer:a,effect:o,curve:100,oversample:"2x"},n}(0,i.Z)(e,t);var n=e.prototype;return n.stop=function(){this.state.soundPlayer.stopSound("guitar")},n.play=function(){this.state.soundPlayer.playSound("guitar")},n.updateState=function(t,e){this.setState((function(n){var i;return(i={})[t]=e,i}))},n.handleSetCurve=function(t){this.updateState("curve",Number(t.target.value)),this.state.effect.setCurve(Number(t.target.value))},n.handleSetOversample=function(t){this.updateState("oversample",t.target.value),this.state.effect.setOversample(t.target.value)},n.render=function(){var t=this;return a.createElement("div",null,a.createElement("h2",null,"Distortion"),a.createElement("pre",null,a.createElement("code",null,"\n            const audioEngine = new AE.AudioEngine()\n            const effect = audioEngine.createEffect('Distortion')\n            const effectsChannel = audioEngine.createChannelStrip('effects', [\n              effect\n            ])\n        \n            const soundPlayer = audioEngine.createSoundPlayer('soundPlayer', {\n              guitar: {\n                path: '../../static/sounds/guitar.mp3',\n                type: 'loop',\n                volume: 1,\n              }\n            })\n\n            soundPlayer.connect(effectsChannel)\n\n            this.state.soundPlayer.playSound('guitar')\n            ")),a.createElement("button",{onClick:function(){return t.stop()}},"Stop"),a.createElement("button",{onClick:function(){return t.play()}},"Play"),a.createElement("div",null,a.createElement("label",{htmlFor:"curve"},"Distortion curve : ",this.state.curve),a.createElement("br",null),a.createElement("input",{name:"curve",type:"range",min:"0",max:"1000",step:"10",value:this.state.curve,onChange:function(e){return t.handleSetCurve(e)}})),a.createElement("div",null,a.createElement("label",{htmlFor:"oversample"},"Oversample : ",this.state.oversample),a.createElement("select",{name:"oversample",value:this.state.oversample,onChange:function(e){return t.handleSetOversample(e)}},a.createElement("option",{value:"none"},"None"),a.createElement("option",{value:"2x"},"2x"),a.createElement("option",{value:"4x"},"4x"))))},e}(a.Component),l=function(t){function e(e){var n;n=t.call(this,e)||this;var i=new r.Z.AudioEngine,o=i.createSoundPlayer("soundPlayer",{synth:{path:"../../static/sounds/synth.mp3",type:"loop",volume:1}}),u=i.createEffect("Filter"),a=i.createChannelStrip("effects",[u]);return o.connect(a),n.state={audioEngine:i,soundPlayer:o,effect:u,frequency:400,Q:10,filterGain:1,filterType:"lowpass"},n}(0,i.Z)(e,t);var n=e.prototype;return n.stop=function(){this.state.soundPlayer.stopSound("synth")},n.play=function(){this.state.soundPlayer.playSound("synth")},n.updateState=function(t,e){this.setState((function(n){var i;return(i={})[t]=e,i}))},n.handleSetFrequency=function(t){this.updateState("frequency",Number(t.target.value)),this.state.effect.setFrequency(Number(t.target.value))},n.handleSetQ=function(t){this.updateState("Q",Number(t.target.value)),this.state.effect.setQ(Number(t.target.value))},n.handleSetfilterGain=function(t){this.updateState("filterGain",Number(t.target.value)),this.state.effect.setFilterGain(Number(t.target.value))},n.handleSetFilterType=function(t){this.updateState("filterType",t.target.value),this.state.effect.setFilterType(t.target.value)},n.render=function(){var t=this;return a.createElement("div",null,a.createElement("h2",null,"Filter"),a.createElement("pre",null,a.createElement("code",null,"\n            const audioEngine = new AE.AudioEngine()\n            const soundPlayer = audioEngine.createSoundPlayer('soundPlayer', {\n              synth: {\n                path: '../../static/sounds/synth.mp3',\n                type: 'loop',\n                volume: 1,\n              }\n            })\n\n            const effect = audioEngine.createEffect('Filter')\n        \n            const effectsChannel = audioEngine.createChannelStrip('effects', [\n              effect\n            ])\n        \n            soundPlayer.connect(effectsChannel)\n\n            this.state.soundPlayer.playSound('synth')\n            ")),a.createElement("button",{onClick:function(){return t.stop()}},"Stop"),a.createElement("button",{onClick:function(){return t.play()}},"Play"),a.createElement("div",null,a.createElement("label",{htmlFor:"frequency"},"Frequency : ",this.state.frequency),a.createElement("br",null),a.createElement("input",{name:"frequency",type:"range",min:"0",max:"20000",step:"10",value:this.state.frequency,onChange:function(e){return t.handleSetFrequency(e)}})),a.createElement("div",null,a.createElement("label",{htmlFor:"Q"},"Q : ",this.state.Q),a.createElement("br",null),a.createElement("input",{name:"Q",type:"range",min:"0",max:"50",value:this.state.Q,onChange:function(e){return t.handleSetQ(e)}})),a.createElement("div",null,a.createElement("label",{htmlFor:"filterGain"},"Gain : ",this.state.filterGain),a.createElement("br",null),a.createElement("input",{name:"filterGain",type:"range",min:"0",max:"1",step:"0.01",value:this.state.filterGain,onChange:function(e){return t.handleSetfilterGain(e)}})),a.createElement("div",null,a.createElement("label",{htmlFor:"filterType"},"Filter type : ",this.state.filterType),a.createElement("select",{name:"filterType",value:this.state.filterType,onChange:function(e){return t.handleSetFilterType(e)}},a.createElement("option",{value:"bandpass"},"Bandpass"),a.createElement("option",{value:"highpass"},"Highpass"),a.createElement("option",{value:"highshelf"},"Highshelf"),a.createElement("option",{value:"lowpass"},"Lowpass"),a.createElement("option",{value:"lowshelf"},"Lowshelf"),a.createElement("option",{value:"notch"},"Notch"),a.createElement("option",{value:"peaking"},"Peaking"))))},e}(a.Component),p=function(t){function e(e){var n;n=t.call(this,e)||this;var i=new r.Z.AudioEngine,o=i.createSoundPlayer("soundPlayer",{guitargroup:{path:"../../static/sounds/guitar-group.mp3",type:"loop",volume:1}}),u=i.createEffect("Pan"),a=i.createChannelStrip("effects",[u]);return o.connect(a),n.state={audioEngine:i,soundPlayer:o,effect:u,panValue:0},n}(0,i.Z)(e,t);var n=e.prototype;return n.stop=function(){this.state.soundPlayer.stopSound("guitargroup")},n.play=function(){this.state.soundPlayer.playSound("guitargroup")},n.handleSetPan=function(t){this.updateState("panValue",Number(t.target.value)),this.state.effect.setPan(Number(t.target.value))},n.updateState=function(t,e){this.setState((function(n){var i;return(i={})[t]=e,i}))},n.render=function(){var t=this;return a.createElement("div",null,a.createElement("h2",null,"Panner"),a.createElement("pre",null,a.createElement("code",null,"\n            const audioEngine = new AE.AudioEngine()\n            const soundPlayer = audioEngine.createSoundPlayer('soundPlayer', {\n              guitargroup: {\n                path: '../../static/sounds/guitargroup.mp3',\n                type: 'loop',\n                volume: 1,\n              }\n            })\n\n            const effect = audioEngine.createEffect('Pan')\n        \n            const effectsChannel = audioEngine.createChannelStrip('effects', [\n              effect\n            ])\n        \n            soundPlayer.connect(effectsChannel)\n\n            this.state.soundPlayer.playSound('guitargroup')\n            ")),a.createElement("button",{onClick:function(){return t.stop()}},"Stop"),a.createElement("button",{onClick:function(){return t.play()}},"Play"),a.createElement("div",null,a.createElement("label",{htmlFor:"panValue"},"Pan : ",this.state.panValue),a.createElement("br",null),a.createElement("input",{name:"panValue",type:"range",min:"-1",max:"1",step:"0.01",value:this.state.panValue,onChange:function(e){return t.handleSetPan(e)}})))},e}(a.Component),h=function(t){function e(e){var n;n=t.call(this,e)||this;var i=new r.Z.AudioEngine,o=i.createSoundPlayer("soundPlayer",{drums:{path:"../../static/sounds/drums-group.mp3",type:"loop",volume:1},bass:{path:"../../static/sounds/bass-group.mp3",type:"loop",volume:.5},guitar:{path:"../../static/sounds/guitar-group.mp3",type:"loop",volume:.5}});return n.state={audioEngine:i,soundPlayer:o,drumsVolume:1,bassVolume:.5,guitarVolume:.5},n}(0,i.Z)(e,t);var n=e.prototype;return n.stop=function(){this.state.soundPlayer.stopSound("drums"),this.state.soundPlayer.stopSound("bass"),this.state.soundPlayer.stopSound("guitar")},n.play=function(){this.state.soundPlayer.playSound("drums"),this.state.soundPlayer.playSound("bass"),this.state.soundPlayer.playSound("guitar")},n.updateState=function(t,e){this.setState((function(n){var i;return(i={})[t]=e,i}))},n.handleDrumsVolumeChange=function(t){this.updateState("drumsVolume",t.target.value),this.state.soundPlayer.setSoundVolume("drums",t.target.value)},n.handleBassVolumeChange=function(t){this.updateState("bassVolume",t.target.value/2),this.state.soundPlayer.setSoundVolume("bass",t.target.value/2)},n.handleGuitarVolumeChange=function(t){this.updateState("guitarVolume",t.target.value/2),this.state.soundPlayer.setSoundVolume("guitar",t.target.value/2)},n.render=function(){var t=this;return a.createElement("div",null,a.createElement("h2",null,"Simple multi player"),a.createElement("pre",null,a.createElement("code",null,"\n            const audioEngine = new AE.AudioEngine()\n            const soundPlayer = audioEngine.createSoundPlayer('soundPlayer', {\n              drums: {\n                path: '../../static/sounds/drums-group.mp3',\n                type: 'loop',\n                volume: 1,\n              },\n              bass: {\n                path: '../../static/sounds/bass-group.mp3',\n                type: 'loop',\n                volume: 0.5,\n              },\n              guitar: {\n                path: '../../static/sounds/guitar-group.mp3',\n                type: 'loop',\n                volume: 0.5,\n              }\n            })\n\n            this.state.soundPlayer.playSound('drums')\n            this.state.soundPlayer.playSound('bass')\n            this.state.soundPlayer.playSound('guitar')\n            ")),a.createElement("button",{onClick:function(){return t.stop()}},"Stop"),a.createElement("button",{onClick:function(){return t.play()}},"Play"),a.createElement("div",null,a.createElement("label",{htmlFor:"drumsVolume"},"Drums volume : ",this.state.drumsVolume),a.createElement("br",null),a.createElement("input",{name:"drumsVolume",type:"range",min:"0",max:"1",step:"0.01",value:this.state.drumsVolume,onChange:function(e){return t.handleDrumsVolumeChange(e)}})),a.createElement("div",null,a.createElement("label",{htmlFor:"bassVolume"},"Bass volume : ",this.state.bassVolume),a.createElement("br",null),a.createElement("input",{name:"bassVolume",type:"range",min:"0",max:"1",step:"0.01",value:this.state.bassVolume,onChange:function(e){return t.handleBassVolumeChange(e)}})),a.createElement("div",null,a.createElement("label",{htmlFor:"guitarVolume"},"Guitar volume : ",this.state.guitarVolume),a.createElement("br",null),a.createElement("input",{name:"guitarVolume",type:"range",min:"0",max:"1",step:"0.01",value:this.state.guitarVolume,onChange:function(e){return t.handleGuitarVolumeChange(e)}})))},e}(a.Component),d=function(t){function e(e){var n;n=t.call(this,e)||this;var i=new r.Z.AudioEngine,o=i.createSoundPlayer("soundPlayer",{guitargroup:{path:"../../static/sounds/guitar-group.mp3",type:"loop",volume:1}});return n.state={audioEngine:i,soundPlayer:o},n}(0,i.Z)(e,t);var n=e.prototype;return n.stop=function(){this.state.soundPlayer.stopSound("guitargroup")},n.play=function(){this.state.soundPlayer.playSound("guitargroup")},n.updateState=function(t,e){this.setState((function(n){var i;return(i={})[t]=e,i}))},n.render=function(){var t=this;return a.createElement("div",null,a.createElement("h2",null,"Simple player"),a.createElement("pre",null,a.createElement("code",null,"\n            const audioEngine = new AE.AudioEngine()\n            const soundPlayer = audioEngine.createSoundPlayer('soundPlayer', {\n              guitargroup: {\n                path: '../../static/sounds/guitargroup.mp3',\n                type: 'loop',\n                volume: 1,\n              }\n            })\n\n            this.state.soundPlayer.playSound('guitargroup')\n            ")),a.createElement("button",{onClick:function(){return t.stop()}},"Stop"),a.createElement("button",{onClick:function(){return t.play()}},"Play"))},e}(a.Component),f=function(t){function e(e){return t.call(this,e)||this}return(0,i.Z)(e,t),e.prototype.render=function(){return a.createElement(u.Z,{title:"Hello from "+this.props.config.title,description:"Description will go into a meta tag in <head />"},a.createElement("h1",null,"Examples"),a.createElement("p",null,"Here are some examples"),a.createElement(o.Z,{fallback:a.createElement("div",null,"Loading...")},(function(){return a.createElement(a.Fragment,null,a.createElement(d,null),a.createElement(h,null),a.createElement(s,null),a.createElement(c,null),a.createElement(l,null),a.createElement(p,null))})))},e}(a.Component)},5462:function(t,e,n){n.d(e,{Z:function(){return Nt}});var i={};n.r(i),n.d(i,{interpolateCosine:function(){return x},linear:function(){return w},perlinSmoothStep:function(){return P},smoothStep:function(){return S},step:function(){return C}});var o={};n.r(o),n.d(o,{easeInCirc:function(){return O},easeInCubic:function(){return F},easeInExpo:function(){return D},easeInQuad:function(){return A},easeInQuart:function(){return N},easeInQuint:function(){return T},easeInSine:function(){return k}});var u={};n.r(u),n.d(u,{clippingSample:function(){return V}});var a={};n.r(a),n.d(a,{_:function(){return J},acceleration:function(){return o},audioWorklets:function(){return u},buildImpulse:function(){return B},clamp:function(){return K},dbToGain:function(){return Z},equalPowerScale:function(){return I},frequencyToMidiNote:function(){return L},frequencyToMidiNoteFloat:function(){return $},gainToDb:function(){return W},getA4:function(){return Q},interpolation:function(){return i},intervalToFrequencyRatio:function(){return j},makeDistortionCurve:function(){return tt},midiToFrequency:function(){return z},millisecondsToSeconds:function(){return q},secondsToMilliseconds:function(){return M},setA4:function(){return H}});var r={};n.r(r),n.d(r,{ChannelStrip:function(){return pt},MixChannel:function(){return ht}});var s={};n.r(s),n.d(s,{Delay:function(){return dt},Distortion:function(){return ft},Filter:function(){return mt},Pan:function(){return yt},Reverb:function(){return _t},_3BandEQ:function(){return vt}});var c={};n.r(c),n.d(c,{Envelope:function(){return Et}});var l={};n.r(l),n.d(l,{Oscillator:function(){return Ct}});var p={};n.r(p),n.d(p,{Arpegiator:function(){return xt},AudioInput:function(){return bt},Monark:function(){return wt},SimpleMonoSynth:function(){return St},SimplePolySynth:function(){return Pt}});var h={};n.r(h),n.d(h,{KeyboardInput:function(){return it},MidiInput:function(){return ut}});var d=n(3144),f=n(7757),m=n.n(f),y=n(1721),_=n(1906),v=n(9285),g=n(5631),b=n(9450),E=function(){function t(){this._subject$=new v.X(g.E)}var e=t.prototype;return e.subscribe=function(t){this._subscription=this.observable$.subscribe(t)},e.unsubscribe=function(){this._subscription.unsubscribe()},(0,d.Z)(t,[{key:"observable$",get:function(){return this._subject$.pipe((0,b.w)((function(t){return t})))}}]),t}();function C(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),t>=e+(n-e)/2?n:e}function w(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),e*(1-t)+n*t}function S(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),w(t*t*(3-2*t),e,n)}function P(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),w(t*t*t*(t*(6*t-15)+10),e,n)}function x(t,e,n){void 0===e&&(e=0),void 0===n&&(n=1);var i=t*Math.PI;return w(.5*(1-Math.cos(i)),e,n)}function k(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),w(1-Math.cos(t*Math.PI/2),e,n)}function A(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),w(t*t,e,n)}function F(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),w(t*t*t,e,n)}function N(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),w(t*t*t*t,e,n)}function T(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),w(t*t*t*t*t,e,n)}function D(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),w(0===t?0:Math.pow(2,10*t-10),e,n)}function O(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),w(1-Math.sqrt(1-Math.pow(t,2)),e,n)}var G=function(t,e,n,i){return new(n||(n=Promise))((function(o,u){function a(t){try{s(i.next(t))}catch(e){u(e)}}function r(t){try{s(i.throw(t))}catch(e){u(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}s((i=i.apply(t,e||[])).next())}))};function V(t,e){return G(this,void 0,void 0,m().mark((function n(){var i;return m().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e,n.next=3,t.audioWorklet.addModule("../../core/audioWorklets/clipping.worklet.js");case 3:i=new AudioWorkletNode(t,"clipping-processor"),e.connect(i);case 5:case"end":return n.stop()}}),n)})))}function B(t){var e,n,i=this._context.sampleRate,o=i*t.seconds,u=t.decay,a=this._context.createBuffer(2,o,i),r=a.getChannelData(0),s=a.getChannelData(1);for(n=0;n<o;n++)e=t.reverse?o-n:n,r[n]=(2*Math.random()-1)*Math.pow(1-e/o,u),s[n]=(2*Math.random()-1)*Math.pow(1-e/o,u);return a}function M(t){return 1e3*t}function q(t){return t/1e3}function I(t){var e=.5*Math.PI;return Math.sin(t*e)}function Z(t){return Math.pow(10,t/20)}function W(t){return Math.log(t)/Math.LN10*20}function j(t){return Math.pow(2,t/12)}var R=440;function Q(){return R}function H(t){R=t}function L(t){return Math.round($(t))}function $(t){return 69+12*Math.log2(t/R)}function z(t){return R*Math.pow(2,(t-69)/12)}function K(t,e,n){return t<e?e:n&&t>n?n:t}function X(t){return[].concat(t)}var U,Y,J={cloneArray:X,exchange:function(t,e,n){var i=X(t);return i.splice(e,1,t[n]),i.splice(n,1,t[e]),i}};function tt(t,e){void 0===t&&(t=100),void 0===e&&(e=44100);for(var n,i=t,o=e,u=new Float32Array(o),a=Math.PI/180,r=0;r<o;++r)n=2*r/o-1,u[r]=(3+i)*n*20*a/(Math.PI+i*Math.abs(n));return u}!function(t){t[t.A0=z(21)]="A0",t[t["A#0"]=z(22)]="A#0",t[t.Bb0=z(22)]="Bb0",t[t.B0=z(23)]="B0",t[t.C1=z(24)]="C1",t[t["C#1"]=z(25)]="C#1",t[t.Db1=z(25)]="Db1",t[t.D1=z(26)]="D1",t[t["D#1"]=z(27)]="D#1",t[t.Eb1=z(27)]="Eb1",t[t.E1=z(28)]="E1",t[t.F1=z(29)]="F1",t[t["F#1"]=z(30)]="F#1",t[t.Gb1=z(30)]="Gb1",t[t.G1=z(31)]="G1",t[t["G#1"]=z(32)]="G#1",t[t.Ab1=z(32)]="Ab1",t[t.A1=z(33)]="A1",t[t["A#1"]=z(34)]="A#1",t[t.Bb1=z(34)]="Bb1",t[t.B1=z(35)]="B1",t[t.C2=z(36)]="C2",t[t["C#2"]=z(37)]="C#2",t[t.Db2=z(37)]="Db2",t[t.D2=z(38)]="D2",t[t["D#2"]=z(39)]="D#2",t[t.Eb2=z(39)]="Eb2",t[t.E2=z(40)]="E2",t[t.F2=z(41)]="F2",t[t["F#2"]=z(42)]="F#2",t[t.Gb2=z(42)]="Gb2",t[t.G2=z(43)]="G2",t[t["G#2"]=z(44)]="G#2",t[t.Ab2=z(44)]="Ab2",t[t.A2=z(45)]="A2",t[t["A#2"]=z(46)]="A#2",t[t.Bb2=z(46)]="Bb2",t[t.B2=z(47)]="B2",t[t.C3=z(48)]="C3",t[t["C#3"]=z(49)]="C#3",t[t.Db3=z(49)]="Db3",t[t.D3=z(50)]="D3",t[t["D#3"]=z(51)]="D#3",t[t.Eb3=z(51)]="Eb3",t[t.E3=z(52)]="E3",t[t.F3=z(53)]="F3",t[t["F#3"]=z(54)]="F#3",t[t.Gb3=z(54)]="Gb3",t[t.G3=z(55)]="G3",t[t["G#3"]=z(56)]="G#3",t[t.Ab3=z(56)]="Ab3",t[t.A3=z(57)]="A3",t[t["A#3"]=z(58)]="A#3",t[t.Bb3=z(58)]="Bb3",t[t.B3=z(59)]="B3",t[t.C4=z(60)]="C4",t[t["C#4"]=z(61)]="C#4",t[t.Db4=z(61)]="Db4",t[t.D4=z(62)]="D4",t[t["D#4"]=z(63)]="D#4",t[t.Eb4=z(63)]="Eb4",t[t.E4=z(64)]="E4",t[t.F4=z(65)]="F4",t[t["F#4"]=z(66)]="F#4",t[t.Gb4=z(66)]="Gb4",t[t.G4=z(67)]="G4",t[t["G#4"]=z(68)]="G#4",t[t.Ab4=z(68)]="Ab4",t[t.A4=z(69)]="A4",t[t["A#4"]=z(70)]="A#4",t[t.Bb4=z(70)]="Bb4",t[t.B4=z(71)]="B4",t[t.C5=z(72)]="C5",t[t["C#5"]=z(73)]="C#5",t[t.Db5=z(73)]="Db5",t[t.D5=z(74)]="D5",t[t["D#5"]=z(75)]="D#5",t[t.Eb5=z(75)]="Eb5",t[t.E5=z(76)]="E5",t[t.F5=z(77)]="F5",t[t["F#5"]=z(78)]="F#5",t[t.Gb5=z(78)]="Gb5",t[t.G5=z(79)]="G5",t[t["G#5"]=z(80)]="G#5",t[t.Ab5=z(80)]="Ab5",t[t.A5=z(81)]="A5",t[t["A#5"]=z(82)]="A#5",t[t.Bb5=z(82)]="Bb5",t[t.B5=z(83)]="B5",t[t.C6=z(84)]="C6",t[t["C#6"]=z(85)]="C#6",t[t.Db6=z(85)]="Db6",t[t.D6=z(86)]="D6",t[t["D#6"]=z(87)]="D#6",t[t.Eb6=z(87)]="Eb6",t[t.E6=z(88)]="E6",t[t.F6=z(89)]="F6",t[t["F#6"]=z(90)]="F#6",t[t.Gb6=z(90)]="Gb6",t[t.G6=z(91)]="G6",t[t["G#6"]=z(92)]="G#6",t[t.Ab6=z(92)]="Ab6",t[t.A6=z(93)]="A6",t[t["A#6"]=z(94)]="A#6",t[t.Bb6=z(94)]="Bb6",t[t.B6=z(95)]="B6",t[t.C7=z(96)]="C7",t[t["C#7"]=z(97)]="C#7",t[t.Db7=z(97)]="Db7",t[t.D7=z(98)]="D7",t[t["D#7"]=z(99)]="D#7",t[t.Eb7=z(99)]="Eb7",t[t.E7=z(100)]="E7",t[t.F7=z(101)]="F7",t[t["F#7"]=z(102)]="F#7",t[t.Gb7=z(102)]="Gb7",t[t.G7=z(103)]="G7",t[t["G#7"]=z(104)]="G#7",t[t.Ab7=z(104)]="Ab7",t[t.A7=z(105)]="A7",t[t["A#7"]=z(106)]="A#7",t[t.Bb7=z(106)]="Bb7",t[t.B7=z(107)]="B7",t[t.C8=z(108)]="C8"}(U||(U={})),function(t){t.azerty="azerty",t.qwerty="qwerty"}(Y||(Y={}));var et={0:[U.C1,U.C2,U.C3,U.C4,U.C5,U.C6,U.C7],1:[U["C#1"],U["C#2"],U["C#3"],U["C#4"],U["C#5"],U["C#6"],U["C#7"]],2:[U.D1,U.D2,U.D3,U.D4,U.D5,U.D6,U.D7],3:[U["D#1"],U["D#2"],U["D#3"],U["D#4"],U["D#5"],U["D#6"],U["D#7"]],4:[U.E1,U.E2,U.E3,U.E4,U.E5,U.E6,U.E7],5:[U.F1,U.F2,U.F3,U.F4,U.F5,U.F6,U.F7],6:[U["F#1"],U["F#2"],U["F#3"],U["F#4"],U["F#5"],U["F#6"],U["F#7"]],7:[U.G1,U.G2,U.G3,U.G4,U.G5,U.G6,U.G7],8:[U["G#1"],U["G#2"],U["G#3"],U["G#4"],U["G#5"],U["G#6"],U["G#7"]],9:[U.A1,U.A2,U.A3,U.A4,U.A5,U.A6,U.A7],10:[U["A#1"],U["A#2"],U["A#3"],U["A#4"],U["A#5"],U["A#6"],U["A#7"]],11:[U.B1,U.B2,U.B3,U.B4,U.B5,U.B6,U.B7]},nt=[{type:Y.qwerty,map:["q","z","s","e","d","f","t","g","y","h","u","j"]},{type:Y.azerty,map:["q","z","s","e","d","f","t","g","y","h","u","j"]}],it=function(t){function e(){var e;return(e=t.call(this)||this).keyboardType=Y.azerty,e._octave=1,e._subject$.next(new _.y((function(t){document.addEventListener("keydown",(function(n){e._keyboard.map.includes(n.key)&&(n.repeat||t.next(e.handleKeyEvent("NOTE_ON",n)))})),document.addEventListener("keyup",(function(n){e._keyboard.map.includes(n.key)&&t.next(e.handleKeyEvent("NOTE_OFF",n))}))}))),e}return(0,y.Z)(e,t),e.prototype.handleKeyEvent=function(t,e){return{type:t,note:et[this._keyboard.map.indexOf(e.key)][this._octave]}},(0,d.Z)(e,[{key:"keyboardType",set:function(t){this._keyboard=nt.some((function(e){return e.type===t}))?nt.find((function(e){return e.type===t})):nt[0]}},{key:"octave",set:function(t){this._octave=K(t,0,6)}}]),e}(E),ot=function(t,e,n,i){return new(n||(n=Promise))((function(o,u){function a(t){try{s(i.next(t))}catch(e){u(e)}}function r(t){try{s(i.throw(t))}catch(e){u(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}s((i=i.apply(t,e||[])).next())}))},ut=function(t){function e(){var e;return(e=t.call(this)||this)._init(),e}return(0,y.Z)(e,t),e.prototype._init=function(){return ot(this,void 0,void 0,m().mark((function t(){var e=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.requestMIDIAccess();case 2:this._midiAccess=t.sent,this._subject$.next(new _.y((function(t){e._midiAccess.onstatechange=function(t){console.log(t.port.name,t.port.manufacturer,t.port.state)},Array.from(e._midiAccess.inputs).forEach((function(e){e[1].onmidimessage=function(e){var n=e.data[0]>>4;console.log("msg.data[1] : ",e.data[1]);var i=e.data[2];8===n||9===n&&0===i?t.next({type:"NOTE_OFF",note:44,velocity:i}):t.next({type:"NOTE_ON",note:44,velocity:i})}}))})));case 4:case"end":return t.stop()}}),t,this)})))},e}(E),at=function(t){function e(e){var n;return(n=t.call(this)||this)._context=e,n._midiInput=new ut,n._keyboardInput=new it,n._output=new GainNode(n._context),n}(0,y.Z)(e,t);var n=e.prototype;return n.setGain=function(t){this._output.gain.value=t},n.connect=function(t){return this._output.disconnect(),"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},e}((function(){})),rt=function(){function t(t){this._context=t,this._input=new GainNode(this._context),this._output=new GainNode(this._context)}var e=t.prototype;return e.connect=function(t){return"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},e.setGain=function(t){this._output.gain.value=t},(0,d.Z)(t,[{key:"input",get:function(){return this._input}},{key:"output",get:function(){return this._output}}]),t}(),st=function(){function t(){this._optionsSubject$=new v.X(null)}return t.prototype._updateOptions=function(t){this._optionsSubject$.next(Object.assign(Object.assign({},this.options),t))},(0,d.Z)(t,[{key:"options$",get:function(){return this._optionsSubject$.asObservable()}},{key:"options",get:function(){return this._optionsSubject$.value}}]),t}(),ct=function(t){function e(e,n,i){var o;return(o=t.call(this)||this).name=e,o._context=n,"_3BandEQ"===e?o._updateOptions(Object.assign({muted:!1,dryWet:1,gain:1,breakPoints:{lowMid:200,midHigh:2e3},low:{gain:1,Q:1,detune:0},mid:{gain:1,Q:1,detune:0},high:{gain:1,Q:1,detune:0}},i)):"Delay"===e?o._updateOptions(Object.assign({muted:!1,dryWet:.5,gain:1,delayTime:.5,feedback:.5},i)):"Distortion"===e?o._updateOptions(Object.assign({muted:!1,dryWet:1,gain:1,curve:tt(100,o._context.sampleRate),oversample:"2x"},i)):"Filter"===e?o._updateOptions(Object.assign({muted:!1,dryWet:1,gain:1,type:"lowpass",frequency:400,Q:10,detune:0},i)):"Pan"===e?o._updateOptions(Object.assign({muted:!1,dryWet:1,gain:1,pan:0},i)):"Reverb"===e&&o._updateOptions(Object.assign({muted:!1,dryWet:.5,gain:1,seconds:3,decay:2,reverse:!1},i)),o._input=new GainNode(o._context),o._dryChannel=new ht(o._context),o._wetChannel=new ht(o._context),o._output=new GainNode(o._context),o.setDryWetRatio(o.options.dryWet),o._input.connect(o._dryChannel.input).connect(o._dryChannel.output).connect(o._output),o._input.connect(o._wetChannel.input),o._wetChannel.output.connect(o._output),o}(0,y.Z)(e,t);var n=e.prototype;return n.connect=function(t){return"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},n.disconnect=function(){return this._output.disconnect()},n.setGain=function(t){this._updateOptions({outputGain:t}),this._output.gain.value=t},n.setDryWetRatio=function(t){this._updateOptions({dryWet:K(t,0,1)}),this._dryChannel.output.gain.value=1-this.options.dryWet,this._wetChannel.output.gain.value=this.options.dryWet},(0,d.Z)(e,[{key:"muted",get:function(){return this.options.muted},set:function(t){this._updateOptions({muted:t}),!0===this.options.muted?this._input.disconnect(this._wetChannel.input):this._input.connect(this._wetChannel.input)}},{key:"input",get:function(){return this._input}},{key:"output",get:function(){return this._output}}]),e}(st),lt=function(t){function e(e){var n;return(n=t.call(this,e)||this)._subscribeToInputs(),n}(0,y.Z)(e,t);var n=e.prototype;return n._subscribeToInputs=function(){var t=this;this._midiInput.subscribe((function(e){"NOTE_ON"===e.type?t.play(e.note):"NOTE_OFF"===e.type&&t.stop(e.note)})),this._keyboardInput.subscribe((function(e){"NOTE_ON"===e.type?t.play(e.note):"NOTE_OFF"===e.type&&t.stop(e.note)}))},n._unsubscribeToInputs=function(){this._midiInput.unsubscribe(),this._keyboardInput.unsubscribe()},e}(at),pt=function(t){function e(e,n){var i;return(i=t.call(this,e)||this)._effects=[],n&&(Array.isArray(n)?i.addEffects(n):i.addEffect(n)),i}(0,y.Z)(e,t);var n=e.prototype;return n.addEffect=function(t,e){e?this._effects.splice(e,0,t):this._effects.push(t),this._rootEffects()},n.removeEffect=function(t){"number"==typeof t?this._effects.splice(t,1):this._effects=this.effects.filter((function(e){return e!==t})),this._rootEffects()},n.muteEffect=function(t){"number"==typeof t?"output"in this._effects[t]&&(this._effects[t].muted=!0):"output"in t&&"output"in this.effects.find((function(e){return e!==t}))&&(this.effects.find((function(e){return e!==t})).muted=!0),this._rootEffects()},n.unmuteEffect=function(t){"number"==typeof t?"output"in this._effects[t]&&(this._effects[t].muted=!1):"output"in t&&(this.effects.find((function(e){return e!==t})).muted=!1),this._rootEffects()},n.addEffects=function(t,e){var n;e?(n=this._effects).splice.apply(n,[e,0].concat(t)):this._effects=[].concat(this._effects,t);this._rootEffects()},n._rootEffects=function(){if(this._input.disconnect(),this._effects.forEach((function(t){t.disconnect()})),"input"in this._effects[0]?this._input.connect(this._effects[0].input):this._input.connect(this._effects[0]),this._effects.length>1)for(var t=0;t<this._effects.length-1;t++)"input"in this._effects[t+1]?this._effects[t].connect(this._effects[t+1].input):this._effects[t].connect(this._effects[t+1]);this._effects[this._effects.length-1].connect(this._output)},(0,d.Z)(e,[{key:"effects",get:function(){return this._effects}}]),e}(rt),ht=function(t){function e(e){var n;return(n=t.call(this,e)||this)._input.connect(n._output),n}return(0,y.Z)(e,t),e}(rt),dt=function(t){function e(e,n){var i;return void 0===n&&(n={}),(i=t.call(this,"Delay",e,n)||this)._delayNode=new DelayNode(i._context,i.options),i._feedbackNode=new GainNode(i._context),i.setFeedback(i.options.feedback),i._delayNode.connect(i._feedbackNode).connect(i._delayNode),i._rootWetChannel(),i}(0,y.Z)(e,t);var n=e.prototype;return n._rootWetChannel=function(){this._wetChannel.input.connect(this._delayNode).connect(this._wetChannel.output)},n.setDelayTime=function(t){this._updateOptions({delayTime:K(t,0)}),this._delayNode.delayTime.value=this.options.delayTime},n.setFeedback=function(t){this._updateOptions({feedback:K(t,0,1)}),this._feedbackNode.gain.value=this.options.feedback},(0,d.Z)(e,[{key:"delayTime",get:function(){return this._delayNode.delayTime}},{key:"feedback",get:function(){return this._feedbackNode.gain}}]),e}(ct),ft=function(t){function e(e,n){var i;return void 0===n&&(n={}),(i=t.call(this,"Distortion",e,n)||this)._waveShaperNode=new WaveShaperNode(i._context,i.options),i._rootWetChannel(),i}(0,y.Z)(e,t);var n=e.prototype;return n._rootWetChannel=function(){this._wetChannel.input.connect(this._waveShaperNode).connect(this._wetChannel.output)},n.setCurve=function(t){"number"==typeof t&&(t=tt(K(t,0),this._context.sampleRate),this._waveShaperNode.curve=t),this._updateOptions({curve:t}),this._waveShaperNode.curve=this.options.curve},n.setOversample=function(t){this._updateOptions({oversample:t}),this._waveShaperNode.oversample=this.options.oversample},(0,d.Z)(e,[{key:"oversample",get:function(){return this._waveShaperNode.oversample}}]),e}(ct),mt=function(t){function e(e,n){var i;return void 0===n&&(n={}),(i=t.call(this,"Filter",e,n)||this)._filterNode=new BiquadFilterNode(i._context,i.options),i._rootWetChannel(),i}(0,y.Z)(e,t);var n=e.prototype;return n._rootWetChannel=function(){this._wetChannel.input.connect(this._filterNode).connect(this._wetChannel.output)},n.setFrequency=function(t){this._updateOptions({frequency:t}),this._filterNode.frequency.value=t},n.setQ=function(t){this._updateOptions({Q:t}),this._filterNode.Q.value=this.options.Q},n.setGain=function(t){this._updateOptions({gain:t}),this._filterNode.gain.value=this.options.gain},n.setDetune=function(t){this._updateOptions({detune:t}),this._filterNode.detune.value=this.options.detune},n.setFilterType=function(t){this._updateOptions({type:t}),this._filterNode.type=this.options.type},(0,d.Z)(e,[{key:"frequency",get:function(){return this._filterNode.frequency}},{key:"Q",get:function(){return this._filterNode.Q}},{key:"gain",get:function(){return this._filterNode.gain}},{key:"detune",get:function(){return this._filterNode.detune}}]),e}(ct),yt=function(t){function e(e,n){var i;return void 0===n&&(n={}),(i=t.call(this,"Pan",e,n)||this)._pannerNode=new StereoPannerNode(i._context,i.options),i._rootWetChannel(),i}(0,y.Z)(e,t);var n=e.prototype;return n._rootWetChannel=function(){this._wetChannel.input.connect(this._pannerNode).connect(this._wetChannel.output)},n.setPan=function(t){this._updateOptions({pan:K(t,-1,1)}),this._pannerNode.pan.value=this.options.pan},(0,d.Z)(e,[{key:"pan",get:function(){return this._pannerNode.pan}}]),e}(ct),_t=function(t){function e(e,n){var i;return void 0===n&&(n={}),(i=t.call(this,"Reverb",e,n)||this)._reverbNode=new ConvolverNode(i._context,{buffer:B(i.options)}),i._rootWetChannel(),i}(0,y.Z)(e,t);var n=e.prototype;return n._rootWetChannel=function(){this._wetChannel.input.connect(this._reverbNode).connect(this._wetChannel.output)},n.setSeconds=function(t){this._updateOptions({seconds:t}),this._reverbNode.buffer=B(this.options)},n.setDecay=function(t){this._updateOptions({decay:t}),this._reverbNode.buffer=B(this.options)},n.setReverse=function(t){this._updateOptions({reverse:t}),this._reverbNode.buffer=B(this.options)},e}(ct),vt=function(t){function e(e,n){var i;return void 0===n&&(n={}),(i=t.call(this,"_3BandEQ",e,n)||this)._lowFilterNode=new BiquadFilterNode(i._context,{detune:i.options.low.detune,frequency:i.options.breakPoints.lowMid,type:"lowpass"}),i._midLowFilterNode=new BiquadFilterNode(i._context,{detune:i.options.low.detune,frequency:i.options.breakPoints.lowMid,type:"highpass"}),i._midHighFilterNode=new BiquadFilterNode(i._context,{detune:i.options.low.detune,frequency:i.options.breakPoints.midHigh,type:"lowpass"}),i._midFilterChannel=new pt(i._context,[i._midLowFilterNode,i._midHighFilterNode]),i._highFilterNode=new BiquadFilterNode(i._context,{detune:i.options.low.detune,frequency:i.options.breakPoints.midHigh,type:"highpass"}),i._rootWetChannel(),i}(0,y.Z)(e,t);var n=e.prototype;return n._rootWetChannel=function(){this._wetChannel.input.connect(this._lowFilterNode).connect(this._wetChannel.output),this._wetChannel.input.connect(this._midFilterChannel.input),this._midFilterChannel.output.connect(this._wetChannel.output),this._wetChannel.input.connect(this._highFilterNode).connect(this._wetChannel.output)},n.setLowMidFrequencyBreakpoint=function(t){this._updateOptions({breakPoints:Object.assign(Object.assign({},this.options.breakPoints),{lowMid:t})}),this.options.breakPoints.lowMid=K(t,0,this.options.breakPoints.midHigh),this._lowFilterNode.frequency.value=this.options.breakPoints.lowMid,this._midLowFilterNode.frequency.value=(this.options.breakPoints.lowMid+this.options.breakPoints.midHigh)/2},n.setMidHighFrequencyBreakpoint=function(t){this._updateOptions({breakPoints:Object.assign(Object.assign({},this.options.breakPoints),{midHigh:t})}),this.options.breakPoints.lowMid=K(t,this.options.breakPoints.midHigh,2e4),this._midHighFilterNode.frequency.value=(this.options.breakPoints.lowMid+this.options.breakPoints.midHigh)/2,this._highFilterNode.frequency.value=this.options.breakPoints.midHigh},n.setLowGain=function(t){this._updateOptions({low:Object.assign(Object.assign({},this.options.low),{gain:t})}),this._lowFilterNode.gain.value=t},n.setMidGain=function(t){this._updateOptions({mid:Object.assign(Object.assign({},this.options.mid),{gain:t})}),this._midFilterChannel.setGain(t)},n.setHighGain=function(t){this._updateOptions({high:Object.assign(Object.assign({},this.options.high),{gain:t})}),this._highFilterNode.gain.value=t},e}(ct),gt=function(t,e,n,i){return new(n||(n=Promise))((function(o,u){function a(t){try{s(i.next(t))}catch(e){u(e)}}function r(t){try{s(i.throw(t))}catch(e){u(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}s((i=i.apply(t,e||[])).next())}))},bt=function(){function t(t,e){this._context=t,this._muted=!1,this._init(e)}var e=t.prototype;return e._init=function(t){return gt(this,void 0,void 0,m().mark((function e(){var n=this;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._output=new GainNode(this._context),e.next=3,new Promise((function(t,e){var i="localhost"==window.location.hostname||"127.0.0.1"==window.location.hostname;"https:"==window.location.protocol||i||e("HTTPS is required for microphone access, and this site has no SSL cert yet. Sorry!"),navigator.getUserMedia({audio:!0},(function(e){t(n._context.createMediaStreamSource(e))}),(function(t){e(t)}))}));case 3:this._input=e.sent,this._input.connect(this._output),t?this.connect(t):this.connect(this._context.destination);case 6:case"end":return e.stop()}}),e,this)})))},e.setGain=function(t){this._output.gain.value=t},e.setMuted=function(t){!0===t?this._input.disconnect(this._output):this._input.connect(this._output)},e.connect=function(t){return"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},e.disconnect=function(){return this._output.disconnect()},(0,d.Z)(t,[{key:"gain",get:function(){return this._output.gain}},{key:"muted",get:function(){return this._muted}},{key:"input",get:function(){return this._input}},{key:"output",get:function(){return this._output}}]),t}(),Et=function(t){function e(e,n){var i;return void 0===n&&(n={}),(i=t.call(this)||this)._context=e,i.params=[],i._updateOptions(Object.assign({muted:!1,envelopeType:"exponential",attackTime:10,decayTime:200,sustainValue:.25,releaseTime:1e3},n)),i}(0,y.Z)(e,t);var n=e.prototype;return n.bind=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=1),this.params.push({param:t,minValue:e,maxValue:n})},n.disconnect=function(t){this.params=this.params.filter((function(e){return e.param!==t}))},n.trigger=function(){var t=this;this.params.forEach((function(e){var n=t._context.currentTime;e.param.cancelScheduledValues(n),e.param.setValueAtTime(e.minValue,n),"exponential"===t.options.envelopeType?(e.param.exponentialRampToValueAtTime(e.maxValue,n+q(K(t.options.attackTime,0))),e.param.exponentialRampToValueAtTime(t.options.sustainValue,n+q(K(t.options.attackTime+t.options.decayTime,0)))):(e.param.linearRampToValueAtTime(e.maxValue,n+q(K(t.options.attackTime,0))),e.param.linearRampToValueAtTime(t.options.sustainValue,n+q(K(t.options.attackTime+t.options.decayTime,0))))}))},n.release=function(){var t=this;this.params.forEach((function(e){var n=t._context.currentTime;e.param.cancelScheduledValues(n),e.param.setValueAtTime(t.options.sustainValue,n),"exponential"===t.options.envelopeType?e.param.exponentialRampToValueAtTime(K(e.minValue,.01),n+q(t.options.releaseTime)):e.param.linearRampToValueAtTime(K(e.minValue,0),n+q(t.options.releaseTime))}))},n.setMuted=function(t){this._updateOptions({muted:t})},n.setEnvelopeType=function(t){this._updateOptions({envelopeType:t})},n.setAttackTime=function(t){this._updateOptions({attackTime:K(t,0)})},n.setDecayTime=function(t){this._updateOptions({decayTime:K(t,0)})},n.setSustainValue=function(t){this._updateOptions({sustainValue:K(t,0)})},n.setReleaseTime=function(t){this._updateOptions({releaseTime:K(t,0)})},e}(st),Ct=function(t){function e(e,n){var i;return void 0===n&&(n={}),(i=t.call(this)||this)._context=e,i._voices=[],i._output=new GainNode(i._context),i._updateOptions(Object.assign({type:"square",numberOfVoices:1},n)),i}(0,y.Z)(e,t);var n=e.prototype;return n.connect=function(t){return"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},n.disconnect=function(){return this._output.disconnect()},n.play=function(t){var e=this;("number"==typeof t?[t]:t).forEach((function(t){var n=e._voices.findIndex((function(e){return e.note===t}))>=0,i=e._voices.length>=e.options.numberOfVoices;if(n||i)1===e.options.numberOfVoices&&(e._voices[0].oscillator.frequency.value=t);else{var o=new OscillatorNode(e._context);o.type=e.options.type,o.frequency.value=t,o.connect(e._output),e._voices.push({note:t,oscillator:o}),o.start()}})),console.log("PLAY this._voices : ",this._voices)},n.stop=function(t,e){var n=this;if(console.log("0"),t){console.log("1");var i=this._voices.findIndex((function(e){return e.note===t}));console.log("presentVoiceIndex : ",i),i>=0?(console.log("3"),e?(console.log("5"),setTimeout((function(){n._voices[i].oscillator.stop(),n._voices.splice(i,1)}),e)):(console.log("6"),this._voices[i].oscillator.stop(),this._voices.splice(i,1))):1===this.options.numberOfVoices&&(console.log("4"),this._voices[0].oscillator.stop(),this._voices=[])}else console.log("2"),this._voices.forEach((function(t){t.oscillator.stop()})),this._voices=[];console.log("STOP this._voices : ",this._voices)},(0,d.Z)(e,[{key:"gain",get:function(){return this._output.gain}},{key:"detune",set:function(t){this._updateOptions({detune:t}),this._voices.forEach((function(e){e.oscillator.detune.value=K(t,0,100)}))}}]),e}(st),wt=function(t){function e(e){var n;return(n=t.call(this,e)||this)._oscillator1=new Ct(e,{type:"square",numberOfVoices:3}),n._oscillator2=new Ct(e,{type:"square",numberOfVoices:3}),n._filter=new mt(e,{}),n._filterEnvelope=new Et(e,{envelopeType:"linear",attackTime:0,decayTime:2e3,sustainValue:0,releaseTime:100}),n._amplitudeEnvelope=new Et(e),n._oscillator1.connect(n._output),n}(0,y.Z)(e,t);var n=e.prototype;return n.play=function(t){this._oscillator1.play(t)},n.stop=function(t){console.log("STOP NOTE : ",t),this._oscillator1.stop(t)},e}(lt),St=function(t){function e(e){var n;return(n=t.call(this,e)||this)._oscillator1=new Ct(e),n._amplitudeEnvelope=new Et(e),n._filter=new mt(e,{}),n._oscillator1.connect(n._filter).connect(n._output),n}(0,y.Z)(e,t);var n=e.prototype;return n.play=function(t){this._oscillator1.play(t)},n.stop=function(){this._oscillator1.stop()},e}(lt),Pt=function(t){function e(e){var n;return(n=t.call(this,e)||this)._oscillator1=new Ct(e,{type:"square",numberOfVoices:8}),n._amplitudeEnvelope=new Et(e),n._filter=new mt(e,{}),n._oscillator1.connect(n._filter).connect(n._output),n}(0,y.Z)(e,t);var n=e.prototype;return n.play=function(t){this._oscillator1.play(t)},n.stop=function(t){this._oscillator1.stop(t)},e}(lt),xt=function(){},kt=function(t,e,n,i){return new(n||(n=Promise))((function(o,u){function a(t){try{s(i.next(t))}catch(e){u(e)}}function r(t){try{s(i.throw(t))}catch(e){u(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}s((i=i.apply(t,e||[])).next())}))},At=function(){function t(t,e,n){this._context=t,this._soundsLibrary=e,this._audioElements={},this._output=new GainNode(this._context),n?this.connect(n):this.connect(this._context.destination)}var e=t.prototype;return e.connect=function(t){return this._output.disconnect(),"input"in t&&"output"in t&&"options"in t||"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},e.setSoundVolume=function(t,e){this._audioElements[t].htmlAudioElement.volume=K(e,0,1)},e.playSound=function(t){return kt(this,void 0,void 0,m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._audioElements[t]){e.next=3;break}return e.next=3,this._loadSound(t);case 3:"oneShotParallel"!==this._soundsLibrary[t].type&&this.stopSound(t),this._audioElements[t].htmlAudioElement.play();case 5:case"end":return e.stop()}}),e,this)})))},e.pauseSound=function(t){this._audioElements[t].htmlAudioElement.pause()},e.stopSound=function(t){this._audioElements[t].htmlAudioElement.pause(),this._audioElements[t].htmlAudioElement.currentTime=0},e._loadSound=function(t){return kt(this,void 0,void 0,m().mark((function e(){var n,i;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._soundsLibrary[t],e.next=3,this._handleSoundLoading(n.path);case 3:i=e.sent,this._audioElements[t]={htmlAudioElement:i,mediaElementAudioSourceNode:this._context.createMediaElementSource(i)},this._audioElements[t].htmlAudioElement.loop="loop"===n.type,this._audioElements[t].htmlAudioElement.volume=K(n.volume,0,1),this._audioElements[t].mediaElementAudioSourceNode.connect(this._output);case 8:case"end":return e.stop()}}),e,this)})))},e._handleSoundLoading=function(t){return kt(this,void 0,void 0,m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,n){var i=new Audio(t);i.oncanplaythrough=function(){e(i)},i.onerror=function(){console.log("onerror"),n()}}));case 2:return e.abrupt("return",new Promise((function(e){var n=new Audio(t);n.oncanplaythrough=function(){e(n)}})));case 3:case"end":return e.stop()}}),e)})))},e.setGain=function(t){this._output.gain.value=t},t}(),Ft=function(t,e,n,i){return new(n||(n=Promise))((function(o,u){function a(t){try{s(i.next(t))}catch(e){u(e)}}function r(t){try{s(i.throw(t))}catch(e){u(e)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,r)}s((i=i.apply(t,e||[])).next())}))},Nt={AudioEngine:function(){function t(){this._masterContext=new AudioContext,this._masterChannel=new ht(this._masterContext),this._mixChannels={},this._channelStrips={},this._soundPlayers={},this._audioInputs={},this._masterChannel.output.connect(this._masterContext.destination)}var e=t.prototype;return e.getMixChannel=function(t){return this._mixChannels[t]},e.getChannelStrip=function(t){return this._channelStrips[t]},e.getSoundPlayer=function(t){return this._soundPlayers[t]},e.getAudioInput=function(t){return this._audioInputs[t]},e.getAduioInputSources=function(){return Ft(this,void 0,void 0,m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new window.InputDeviceInfo);case 1:case"end":return t.stop()}}),t)})))},e.createAudioInput=function(t,e){return void 0===e&&(e="master"),this._audioInputs[t]=new bt(this._masterContext,this._channelToConnectNode(e)),this._audioInputs[t]},e.createSoundPlayer=function(t,e,n){return void 0===n&&(n="master"),this._soundPlayers[t]=new At(this._masterContext,e,this._channelToConnectNode(n)),this._soundPlayers[t]},e.createEffect=function(t,e){return void 0===e&&(e={}),"Delay"===t?new dt(this._masterContext,e):"Distortion"===t?new ft(this._masterContext,e):"Filter"===t?new mt(this._masterContext,e):"Pan"===t?new yt(this._masterContext,e):"Reverb"===t?new _t(this._masterContext,e):void 0},e.createMixChannel=function(t){return this._mixChannels[t]=new ht(this._masterContext),this._mixChannels[t].output.connect(this._masterChannel.input),this._mixChannels[t]},e.createChannelStrip=function(t,e,n){return void 0===e&&(e=[]),void 0===n&&(n="master"),console.log("createChannelStrip name",t),console.log("createChannelStrip effects",e),console.log("createChannelStrip channelName",n),this._channelStrips[t]=new pt(this._masterContext,e),this._channelStrips[t].output.connect(this._channelToConnectNode(n)),this._channelStrips[t]},e._channelToConnectNode=function(t){return console.log("_channelToConnectNode channelName",t),"master"===t?this._masterChannel.input:Object.keys(this._mixChannels).some((function(e){return e===t}))?this._mixChannels[t].input:Object.keys(this._channelStrips).some((function(e){return e===t}))?this._channelStrips[t].input:this._masterChannel.input},(0,d.Z)(t,[{key:"masterContext",get:function(){return this._masterContext}},{key:"masterChannel",get:function(){return this._masterChannel}},{key:"mixChannels",get:function(){return this._mixChannels}},{key:"channelStrips",get:function(){return this._channelStrips}},{key:"soundPlayers",get:function(){return this._soundPlayers}}]),t}(),SoundPlayer:At,channels:r,effects:s,envelopes:c,inputs:h,instruments:p,oscillators:l,utils:a}}}]);