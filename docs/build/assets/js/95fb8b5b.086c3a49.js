"use strict";(self.webpackChunkdocs_2=self.webpackChunkdocs_2||[]).push([[2723],{7504:function(t,n,e){e.r(n),e.d(n,{default:function(){return a}});var i=e(1721),o=e(1262),u=e(6698),r=e(7294),s=e(5462),c=function(t){function n(n){var e;e=t.call(this,n)||this;var i=new s.Z.AudioEngine,o=i.createAudioInput("audioInput");return s.Z.utils.audioWorklets.clippingSample(i.masterContext,o),e.state={audioEngine:i,audioInput:o},e}(0,i.Z)(n,t);var e=n.prototype;return e.componentDidMount=function(){},e.updateState=function(t,n){this.setState((function(e){var i;return(i={})[t]=n,i}))},e.render=function(){return r.createElement(r.Fragment,null,r.createElement("pre",null,r.createElement("code",null,"\n          const audioEngine = new AE.AudioEngine()\n          const audioInput = audioEngine.createAudioInput('audioInput')\n          AE.utils.audioWorklets.clippingSample(audioEngine.masterContext, audioInput)\n        ")))},n}(r.Component),a=function(t){function n(n){return t.call(this,n)||this}return(0,i.Z)(n,t),n.prototype.render=function(){return r.createElement(u.Z,{title:"Hello from "+this.props.config.title,description:"Description will go into a meta tag in <head />"},r.createElement("h1",null,"Audio"),r.createElement("p",null,"Here are some examples"),r.createElement(o.Z,{fallback:r.createElement("div",null,"Loading...")},(function(){return r.createElement(r.Fragment,null,r.createElement(c,null))})))},n}(r.Component)},5462:function(t,n,e){e.d(n,{Z:function(){return Tt}});var i={};e.r(i),e.d(i,{interpolateCosine:function(){return A},linear:function(){return E},perlinSmoothStep:function(){return k},smoothStep:function(){return x},step:function(){return C}});var o={};e.r(o),e.d(o,{easeInCirc:function(){return S},easeInCubic:function(){return F},easeInExpo:function(){return G},easeInQuad:function(){return O},easeInQuart:function(){return T},easeInQuint:function(){return D},easeInSine:function(){return N}});var u={};e.r(u),e.d(u,{clippingSample:function(){return M}});var r={};e.r(r),e.d(r,{_:function(){return J},acceleration:function(){return o},audioWorklets:function(){return u},buildImpulse:function(){return B},clamp:function(){return K},dbToGain:function(){return j},equalPowerScale:function(){return Z},frequencyToMidiNote:function(){return Q},frequencyToMidiNoteFloat:function(){return $},gainToDb:function(){return V},getA4:function(){return H},interpolation:function(){return i},intervalToFrequencyRatio:function(){return W},makeDistortionCurve:function(){return tt},midiToFrequency:function(){return z},millisecondsToSeconds:function(){return q},secondsToMilliseconds:function(){return I},setA4:function(){return L}});var s={};e.r(s),e.d(s,{ChannelStrip:function(){return ht},MixChannel:function(){return lt}});var c={};e.r(c),e.d(c,{Delay:function(){return ft},Distortion:function(){return dt},Filter:function(){return _t},Pan:function(){return mt},Reverb:function(){return vt},_3BandEQ:function(){return yt}});var a={};e.r(a),e.d(a,{Envelope:function(){return gt}});var p={};e.r(p),e.d(p,{Oscillator:function(){return Ct}});var h={};e.r(h),e.d(h,{Arpegiator:function(){return At},AudioInput:function(){return wt},Monark:function(){return Et},SimpleMonoSynth:function(){return xt},SimplePolySynth:function(){return kt}});var l={};e.r(l),e.d(l,{KeyboardInput:function(){return it},MidiInput:function(){return ut}});var f=e(3144),d=e(7757),_=e.n(d),m=e(1721),v=e(1906),y=e(9285),b=e(5631),w=e(9450),g=function(){function t(){this._subject$=new y.X(b.E)}var n=t.prototype;return n.subscribe=function(t){this._subscription=this.observable$.subscribe(t)},n.unsubscribe=function(){this._subscription.unsubscribe()},(0,f.Z)(t,[{key:"observable$",get:function(){return this._subject$.pipe((0,w.w)((function(t){return t})))}}]),t}();function C(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),t>=n+(e-n)/2?e:n}function E(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),n*(1-t)+e*t}function x(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),E(t*t*(3-2*t),n,e)}function k(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),E(t*t*t*(t*(6*t-15)+10),n,e)}function A(t,n,e){void 0===n&&(n=0),void 0===e&&(e=1);var i=t*Math.PI;return E(.5*(1-Math.cos(i)),n,e)}function N(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),E(1-Math.cos(t*Math.PI/2),n,e)}function O(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),E(t*t,n,e)}function F(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),E(t*t*t,n,e)}function T(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),E(t*t*t*t,n,e)}function D(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),E(t*t*t*t*t,n,e)}function G(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),E(0===t?0:Math.pow(2,10*t-10),n,e)}function S(t,n,e){return void 0===n&&(n=0),void 0===e&&(e=1),E(1-Math.sqrt(1-Math.pow(t,2)),n,e)}var P=function(t,n,e,i){return new(e||(e=Promise))((function(o,u){function r(t){try{c(i.next(t))}catch(n){u(n)}}function s(t){try{c(i.throw(t))}catch(n){u(n)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(r,s)}c((i=i.apply(t,n||[])).next())}))};function M(t,n){return P(this,void 0,void 0,_().mark((function e(){var i;return _().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n,e.next=3,t.audioWorklet.addModule("../../core/audioWorklets/clipping.worklet.js");case 3:i=new AudioWorkletNode(t,"clipping-processor"),n.connect(i);case 5:case"end":return e.stop()}}),e)})))}function B(t){var n,e,i=this._context.sampleRate,o=i*t.seconds,u=t.decay,r=this._context.createBuffer(2,o,i),s=r.getChannelData(0),c=r.getChannelData(1);for(e=0;e<o;e++)n=t.reverse?o-e:e,s[e]=(2*Math.random()-1)*Math.pow(1-n/o,u),c[e]=(2*Math.random()-1)*Math.pow(1-n/o,u);return r}function I(t){return 1e3*t}function q(t){return t/1e3}function Z(t){var n=.5*Math.PI;return Math.sin(t*n)}function j(t){return Math.pow(10,t/20)}function V(t){return Math.log(t)/Math.LN10*20}function W(t){return Math.pow(2,t/12)}var R=440;function H(){return R}function L(t){R=t}function Q(t){return Math.round($(t))}function $(t){return 69+12*Math.log2(t/R)}function z(t){return R*Math.pow(2,(t-69)/12)}function K(t,n,e){return t<n?n:e&&t>e?e:t}function X(t){return[].concat(t)}var U,Y,J={cloneArray:X,exchange:function(t,n,e){var i=X(t);return i.splice(n,1,t[e]),i.splice(e,1,t[n]),i}};function tt(t,n){void 0===t&&(t=100),void 0===n&&(n=44100);for(var e,i=t,o=n,u=new Float32Array(o),r=Math.PI/180,s=0;s<o;++s)e=2*s/o-1,u[s]=(3+i)*e*20*r/(Math.PI+i*Math.abs(e));return u}!function(t){t[t.A0=z(21)]="A0",t[t["A#0"]=z(22)]="A#0",t[t.Bb0=z(22)]="Bb0",t[t.B0=z(23)]="B0",t[t.C1=z(24)]="C1",t[t["C#1"]=z(25)]="C#1",t[t.Db1=z(25)]="Db1",t[t.D1=z(26)]="D1",t[t["D#1"]=z(27)]="D#1",t[t.Eb1=z(27)]="Eb1",t[t.E1=z(28)]="E1",t[t.F1=z(29)]="F1",t[t["F#1"]=z(30)]="F#1",t[t.Gb1=z(30)]="Gb1",t[t.G1=z(31)]="G1",t[t["G#1"]=z(32)]="G#1",t[t.Ab1=z(32)]="Ab1",t[t.A1=z(33)]="A1",t[t["A#1"]=z(34)]="A#1",t[t.Bb1=z(34)]="Bb1",t[t.B1=z(35)]="B1",t[t.C2=z(36)]="C2",t[t["C#2"]=z(37)]="C#2",t[t.Db2=z(37)]="Db2",t[t.D2=z(38)]="D2",t[t["D#2"]=z(39)]="D#2",t[t.Eb2=z(39)]="Eb2",t[t.E2=z(40)]="E2",t[t.F2=z(41)]="F2",t[t["F#2"]=z(42)]="F#2",t[t.Gb2=z(42)]="Gb2",t[t.G2=z(43)]="G2",t[t["G#2"]=z(44)]="G#2",t[t.Ab2=z(44)]="Ab2",t[t.A2=z(45)]="A2",t[t["A#2"]=z(46)]="A#2",t[t.Bb2=z(46)]="Bb2",t[t.B2=z(47)]="B2",t[t.C3=z(48)]="C3",t[t["C#3"]=z(49)]="C#3",t[t.Db3=z(49)]="Db3",t[t.D3=z(50)]="D3",t[t["D#3"]=z(51)]="D#3",t[t.Eb3=z(51)]="Eb3",t[t.E3=z(52)]="E3",t[t.F3=z(53)]="F3",t[t["F#3"]=z(54)]="F#3",t[t.Gb3=z(54)]="Gb3",t[t.G3=z(55)]="G3",t[t["G#3"]=z(56)]="G#3",t[t.Ab3=z(56)]="Ab3",t[t.A3=z(57)]="A3",t[t["A#3"]=z(58)]="A#3",t[t.Bb3=z(58)]="Bb3",t[t.B3=z(59)]="B3",t[t.C4=z(60)]="C4",t[t["C#4"]=z(61)]="C#4",t[t.Db4=z(61)]="Db4",t[t.D4=z(62)]="D4",t[t["D#4"]=z(63)]="D#4",t[t.Eb4=z(63)]="Eb4",t[t.E4=z(64)]="E4",t[t.F4=z(65)]="F4",t[t["F#4"]=z(66)]="F#4",t[t.Gb4=z(66)]="Gb4",t[t.G4=z(67)]="G4",t[t["G#4"]=z(68)]="G#4",t[t.Ab4=z(68)]="Ab4",t[t.A4=z(69)]="A4",t[t["A#4"]=z(70)]="A#4",t[t.Bb4=z(70)]="Bb4",t[t.B4=z(71)]="B4",t[t.C5=z(72)]="C5",t[t["C#5"]=z(73)]="C#5",t[t.Db5=z(73)]="Db5",t[t.D5=z(74)]="D5",t[t["D#5"]=z(75)]="D#5",t[t.Eb5=z(75)]="Eb5",t[t.E5=z(76)]="E5",t[t.F5=z(77)]="F5",t[t["F#5"]=z(78)]="F#5",t[t.Gb5=z(78)]="Gb5",t[t.G5=z(79)]="G5",t[t["G#5"]=z(80)]="G#5",t[t.Ab5=z(80)]="Ab5",t[t.A5=z(81)]="A5",t[t["A#5"]=z(82)]="A#5",t[t.Bb5=z(82)]="Bb5",t[t.B5=z(83)]="B5",t[t.C6=z(84)]="C6",t[t["C#6"]=z(85)]="C#6",t[t.Db6=z(85)]="Db6",t[t.D6=z(86)]="D6",t[t["D#6"]=z(87)]="D#6",t[t.Eb6=z(87)]="Eb6",t[t.E6=z(88)]="E6",t[t.F6=z(89)]="F6",t[t["F#6"]=z(90)]="F#6",t[t.Gb6=z(90)]="Gb6",t[t.G6=z(91)]="G6",t[t["G#6"]=z(92)]="G#6",t[t.Ab6=z(92)]="Ab6",t[t.A6=z(93)]="A6",t[t["A#6"]=z(94)]="A#6",t[t.Bb6=z(94)]="Bb6",t[t.B6=z(95)]="B6",t[t.C7=z(96)]="C7",t[t["C#7"]=z(97)]="C#7",t[t.Db7=z(97)]="Db7",t[t.D7=z(98)]="D7",t[t["D#7"]=z(99)]="D#7",t[t.Eb7=z(99)]="Eb7",t[t.E7=z(100)]="E7",t[t.F7=z(101)]="F7",t[t["F#7"]=z(102)]="F#7",t[t.Gb7=z(102)]="Gb7",t[t.G7=z(103)]="G7",t[t["G#7"]=z(104)]="G#7",t[t.Ab7=z(104)]="Ab7",t[t.A7=z(105)]="A7",t[t["A#7"]=z(106)]="A#7",t[t.Bb7=z(106)]="Bb7",t[t.B7=z(107)]="B7",t[t.C8=z(108)]="C8"}(U||(U={})),function(t){t.azerty="azerty",t.qwerty="qwerty"}(Y||(Y={}));var nt={0:[U.C1,U.C2,U.C3,U.C4,U.C5,U.C6,U.C7],1:[U["C#1"],U["C#2"],U["C#3"],U["C#4"],U["C#5"],U["C#6"],U["C#7"]],2:[U.D1,U.D2,U.D3,U.D4,U.D5,U.D6,U.D7],3:[U["D#1"],U["D#2"],U["D#3"],U["D#4"],U["D#5"],U["D#6"],U["D#7"]],4:[U.E1,U.E2,U.E3,U.E4,U.E5,U.E6,U.E7],5:[U.F1,U.F2,U.F3,U.F4,U.F5,U.F6,U.F7],6:[U["F#1"],U["F#2"],U["F#3"],U["F#4"],U["F#5"],U["F#6"],U["F#7"]],7:[U.G1,U.G2,U.G3,U.G4,U.G5,U.G6,U.G7],8:[U["G#1"],U["G#2"],U["G#3"],U["G#4"],U["G#5"],U["G#6"],U["G#7"]],9:[U.A1,U.A2,U.A3,U.A4,U.A5,U.A6,U.A7],10:[U["A#1"],U["A#2"],U["A#3"],U["A#4"],U["A#5"],U["A#6"],U["A#7"]],11:[U.B1,U.B2,U.B3,U.B4,U.B5,U.B6,U.B7]},et=[{type:Y.qwerty,map:["q","z","s","e","d","f","t","g","y","h","u","j"]},{type:Y.azerty,map:["q","z","s","e","d","f","t","g","y","h","u","j"]}],it=function(t){function n(){var n;return(n=t.call(this)||this).keyboardType=Y.azerty,n._octave=1,n._subject$.next(new v.y((function(t){document.addEventListener("keydown",(function(e){n._keyboard.map.includes(e.key)&&(e.repeat||t.next(n.handleKeyEvent("NOTE_ON",e)))})),document.addEventListener("keyup",(function(e){n._keyboard.map.includes(e.key)&&t.next(n.handleKeyEvent("NOTE_OFF",e))}))}))),n}return(0,m.Z)(n,t),n.prototype.handleKeyEvent=function(t,n){return{type:t,note:nt[this._keyboard.map.indexOf(n.key)][this._octave]}},(0,f.Z)(n,[{key:"keyboardType",set:function(t){this._keyboard=et.some((function(n){return n.type===t}))?et.find((function(n){return n.type===t})):et[0]}},{key:"octave",set:function(t){this._octave=K(t,0,6)}}]),n}(g),ot=function(t,n,e,i){return new(e||(e=Promise))((function(o,u){function r(t){try{c(i.next(t))}catch(n){u(n)}}function s(t){try{c(i.throw(t))}catch(n){u(n)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(r,s)}c((i=i.apply(t,n||[])).next())}))},ut=function(t){function n(){var n;return(n=t.call(this)||this)._init(),n}return(0,m.Z)(n,t),n.prototype._init=function(){return ot(this,void 0,void 0,_().mark((function t(){var n=this;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.requestMIDIAccess();case 2:this._midiAccess=t.sent,this._subject$.next(new v.y((function(t){n._midiAccess.onstatechange=function(t){console.log(t.port.name,t.port.manufacturer,t.port.state)},Array.from(n._midiAccess.inputs).forEach((function(n){n[1].onmidimessage=function(n){var e=n.data[0]>>4;console.log("msg.data[1] : ",n.data[1]);var i=n.data[2];8===e||9===e&&0===i?t.next({type:"NOTE_OFF",note:44,velocity:i}):t.next({type:"NOTE_ON",note:44,velocity:i})}}))})));case 4:case"end":return t.stop()}}),t,this)})))},n}(g),rt=function(t){function n(n){var e;return(e=t.call(this)||this)._context=n,e._midiInput=new ut,e._keyboardInput=new it,e._output=new GainNode(e._context),e}(0,m.Z)(n,t);var e=n.prototype;return e.setGain=function(t){this._output.gain.value=t},e.connect=function(t){return this._output.disconnect(),"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},n}((function(){})),st=function(){function t(t){this._context=t,this._input=new GainNode(this._context),this._output=new GainNode(this._context)}var n=t.prototype;return n.connect=function(t){return"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},n.setGain=function(t){this._output.gain.value=t},(0,f.Z)(t,[{key:"input",get:function(){return this._input}},{key:"output",get:function(){return this._output}}]),t}(),ct=function(){function t(){this._optionsSubject$=new y.X(null)}return t.prototype._updateOptions=function(t){this._optionsSubject$.next(Object.assign(Object.assign({},this.options),t))},(0,f.Z)(t,[{key:"options$",get:function(){return this._optionsSubject$.asObservable()}},{key:"options",get:function(){return this._optionsSubject$.value}}]),t}(),at=function(t){function n(n,e,i){var o;return(o=t.call(this)||this).name=n,o._context=e,"_3BandEQ"===n?o._updateOptions(Object.assign({muted:!1,dryWet:1,gain:1,breakPoints:{lowMid:200,midHigh:2e3},low:{gain:1,Q:1,detune:0},mid:{gain:1,Q:1,detune:0},high:{gain:1,Q:1,detune:0}},i)):"Delay"===n?o._updateOptions(Object.assign({muted:!1,dryWet:.5,gain:1,delayTime:.5,feedback:.5},i)):"Distortion"===n?o._updateOptions(Object.assign({muted:!1,dryWet:1,gain:1,curve:tt(100,o._context.sampleRate),oversample:"2x"},i)):"Filter"===n?o._updateOptions(Object.assign({muted:!1,dryWet:1,gain:1,type:"lowpass",frequency:400,Q:10,detune:0},i)):"Pan"===n?o._updateOptions(Object.assign({muted:!1,dryWet:1,gain:1,pan:0},i)):"Reverb"===n&&o._updateOptions(Object.assign({muted:!1,dryWet:.5,gain:1,seconds:3,decay:2,reverse:!1},i)),o._input=new GainNode(o._context),o._dryChannel=new lt(o._context),o._wetChannel=new lt(o._context),o._output=new GainNode(o._context),o.setDryWetRatio(o.options.dryWet),o._input.connect(o._dryChannel.input).connect(o._dryChannel.output).connect(o._output),o._input.connect(o._wetChannel.input),o._wetChannel.output.connect(o._output),o}(0,m.Z)(n,t);var e=n.prototype;return e.connect=function(t){return"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},e.disconnect=function(){return this._output.disconnect()},e.setGain=function(t){this._updateOptions({outputGain:t}),this._output.gain.value=t},e.setDryWetRatio=function(t){this._updateOptions({dryWet:K(t,0,1)}),this._dryChannel.output.gain.value=1-this.options.dryWet,this._wetChannel.output.gain.value=this.options.dryWet},(0,f.Z)(n,[{key:"muted",get:function(){return this.options.muted},set:function(t){this._updateOptions({muted:t}),!0===this.options.muted?this._input.disconnect(this._wetChannel.input):this._input.connect(this._wetChannel.input)}},{key:"input",get:function(){return this._input}},{key:"output",get:function(){return this._output}}]),n}(ct),pt=function(t){function n(n){var e;return(e=t.call(this,n)||this)._subscribeToInputs(),e}(0,m.Z)(n,t);var e=n.prototype;return e._subscribeToInputs=function(){var t=this;this._midiInput.subscribe((function(n){"NOTE_ON"===n.type?t.play(n.note):"NOTE_OFF"===n.type&&t.stop(n.note)})),this._keyboardInput.subscribe((function(n){"NOTE_ON"===n.type?t.play(n.note):"NOTE_OFF"===n.type&&t.stop(n.note)}))},e._unsubscribeToInputs=function(){this._midiInput.unsubscribe(),this._keyboardInput.unsubscribe()},n}(rt),ht=function(t){function n(n,e){var i;return(i=t.call(this,n)||this)._effects=[],e&&(Array.isArray(e)?i.addEffects(e):i.addEffect(e)),i}(0,m.Z)(n,t);var e=n.prototype;return e.addEffect=function(t,n){n?this._effects.splice(n,0,t):this._effects.push(t),this._rootEffects()},e.removeEffect=function(t){"number"==typeof t?this._effects.splice(t,1):this._effects=this.effects.filter((function(n){return n!==t})),this._rootEffects()},e.muteEffect=function(t){"number"==typeof t?"output"in this._effects[t]&&(this._effects[t].muted=!0):"output"in t&&"output"in this.effects.find((function(n){return n!==t}))&&(this.effects.find((function(n){return n!==t})).muted=!0),this._rootEffects()},e.unmuteEffect=function(t){"number"==typeof t?"output"in this._effects[t]&&(this._effects[t].muted=!1):"output"in t&&(this.effects.find((function(n){return n!==t})).muted=!1),this._rootEffects()},e.addEffects=function(t,n){var e;n?(e=this._effects).splice.apply(e,[n,0].concat(t)):this._effects=[].concat(this._effects,t);this._rootEffects()},e._rootEffects=function(){if(this._input.disconnect(),this._effects.forEach((function(t){t.disconnect()})),"input"in this._effects[0]?this._input.connect(this._effects[0].input):this._input.connect(this._effects[0]),this._effects.length>1)for(var t=0;t<this._effects.length-1;t++)"input"in this._effects[t+1]?this._effects[t].connect(this._effects[t+1].input):this._effects[t].connect(this._effects[t+1]);this._effects[this._effects.length-1].connect(this._output)},(0,f.Z)(n,[{key:"effects",get:function(){return this._effects}}]),n}(st),lt=function(t){function n(n){var e;return(e=t.call(this,n)||this)._input.connect(e._output),e}return(0,m.Z)(n,t),n}(st),ft=function(t){function n(n,e){var i;return void 0===e&&(e={}),(i=t.call(this,"Delay",n,e)||this)._delayNode=new DelayNode(i._context,i.options),i._feedbackNode=new GainNode(i._context),i.setFeedback(i.options.feedback),i._delayNode.connect(i._feedbackNode).connect(i._delayNode),i._rootWetChannel(),i}(0,m.Z)(n,t);var e=n.prototype;return e._rootWetChannel=function(){this._wetChannel.input.connect(this._delayNode).connect(this._wetChannel.output)},e.setDelayTime=function(t){this._updateOptions({delayTime:K(t,0)}),this._delayNode.delayTime.value=this.options.delayTime},e.setFeedback=function(t){this._updateOptions({feedback:K(t,0,1)}),this._feedbackNode.gain.value=this.options.feedback},(0,f.Z)(n,[{key:"delayTime",get:function(){return this._delayNode.delayTime}},{key:"feedback",get:function(){return this._feedbackNode.gain}}]),n}(at),dt=function(t){function n(n,e){var i;return void 0===e&&(e={}),(i=t.call(this,"Distortion",n,e)||this)._waveShaperNode=new WaveShaperNode(i._context,i.options),i._rootWetChannel(),i}(0,m.Z)(n,t);var e=n.prototype;return e._rootWetChannel=function(){this._wetChannel.input.connect(this._waveShaperNode).connect(this._wetChannel.output)},e.setCurve=function(t){"number"==typeof t&&(t=tt(K(t,0),this._context.sampleRate),this._waveShaperNode.curve=t),this._updateOptions({curve:t}),this._waveShaperNode.curve=this.options.curve},e.setOversample=function(t){this._updateOptions({oversample:t}),this._waveShaperNode.oversample=this.options.oversample},(0,f.Z)(n,[{key:"oversample",get:function(){return this._waveShaperNode.oversample}}]),n}(at),_t=function(t){function n(n,e){var i;return void 0===e&&(e={}),(i=t.call(this,"Filter",n,e)||this)._filterNode=new BiquadFilterNode(i._context,i.options),i._rootWetChannel(),i}(0,m.Z)(n,t);var e=n.prototype;return e._rootWetChannel=function(){this._wetChannel.input.connect(this._filterNode).connect(this._wetChannel.output)},e.setFrequency=function(t){this._updateOptions({frequency:t}),this._filterNode.frequency.value=t},e.setQ=function(t){this._updateOptions({Q:t}),this._filterNode.Q.value=this.options.Q},e.setGain=function(t){this._updateOptions({gain:t}),this._filterNode.gain.value=this.options.gain},e.setDetune=function(t){this._updateOptions({detune:t}),this._filterNode.detune.value=this.options.detune},e.setFilterType=function(t){this._updateOptions({type:t}),this._filterNode.type=this.options.type},(0,f.Z)(n,[{key:"frequency",get:function(){return this._filterNode.frequency}},{key:"Q",get:function(){return this._filterNode.Q}},{key:"gain",get:function(){return this._filterNode.gain}},{key:"detune",get:function(){return this._filterNode.detune}}]),n}(at),mt=function(t){function n(n,e){var i;return void 0===e&&(e={}),(i=t.call(this,"Pan",n,e)||this)._pannerNode=new StereoPannerNode(i._context,i.options),i._rootWetChannel(),i}(0,m.Z)(n,t);var e=n.prototype;return e._rootWetChannel=function(){this._wetChannel.input.connect(this._pannerNode).connect(this._wetChannel.output)},e.setPan=function(t){this._updateOptions({pan:K(t,-1,1)}),this._pannerNode.pan.value=this.options.pan},(0,f.Z)(n,[{key:"pan",get:function(){return this._pannerNode.pan}}]),n}(at),vt=function(t){function n(n,e){var i;return void 0===e&&(e={}),(i=t.call(this,"Reverb",n,e)||this)._reverbNode=new ConvolverNode(i._context,{buffer:B(i.options)}),i._rootWetChannel(),i}(0,m.Z)(n,t);var e=n.prototype;return e._rootWetChannel=function(){this._wetChannel.input.connect(this._reverbNode).connect(this._wetChannel.output)},e.setSeconds=function(t){this._updateOptions({seconds:t}),this._reverbNode.buffer=B(this.options)},e.setDecay=function(t){this._updateOptions({decay:t}),this._reverbNode.buffer=B(this.options)},e.setReverse=function(t){this._updateOptions({reverse:t}),this._reverbNode.buffer=B(this.options)},n}(at),yt=function(t){function n(n,e){var i;return void 0===e&&(e={}),(i=t.call(this,"_3BandEQ",n,e)||this)._lowFilterNode=new BiquadFilterNode(i._context,{detune:i.options.low.detune,frequency:i.options.breakPoints.lowMid,type:"lowpass"}),i._midLowFilterNode=new BiquadFilterNode(i._context,{detune:i.options.low.detune,frequency:i.options.breakPoints.lowMid,type:"highpass"}),i._midHighFilterNode=new BiquadFilterNode(i._context,{detune:i.options.low.detune,frequency:i.options.breakPoints.midHigh,type:"lowpass"}),i._midFilterChannel=new ht(i._context,[i._midLowFilterNode,i._midHighFilterNode]),i._highFilterNode=new BiquadFilterNode(i._context,{detune:i.options.low.detune,frequency:i.options.breakPoints.midHigh,type:"highpass"}),i._rootWetChannel(),i}(0,m.Z)(n,t);var e=n.prototype;return e._rootWetChannel=function(){this._wetChannel.input.connect(this._lowFilterNode).connect(this._wetChannel.output),this._wetChannel.input.connect(this._midFilterChannel.input),this._midFilterChannel.output.connect(this._wetChannel.output),this._wetChannel.input.connect(this._highFilterNode).connect(this._wetChannel.output)},e.setLowMidFrequencyBreakpoint=function(t){this._updateOptions({breakPoints:Object.assign(Object.assign({},this.options.breakPoints),{lowMid:t})}),this.options.breakPoints.lowMid=K(t,0,this.options.breakPoints.midHigh),this._lowFilterNode.frequency.value=this.options.breakPoints.lowMid,this._midLowFilterNode.frequency.value=(this.options.breakPoints.lowMid+this.options.breakPoints.midHigh)/2},e.setMidHighFrequencyBreakpoint=function(t){this._updateOptions({breakPoints:Object.assign(Object.assign({},this.options.breakPoints),{midHigh:t})}),this.options.breakPoints.lowMid=K(t,this.options.breakPoints.midHigh,2e4),this._midHighFilterNode.frequency.value=(this.options.breakPoints.lowMid+this.options.breakPoints.midHigh)/2,this._highFilterNode.frequency.value=this.options.breakPoints.midHigh},e.setLowGain=function(t){this._updateOptions({low:Object.assign(Object.assign({},this.options.low),{gain:t})}),this._lowFilterNode.gain.value=t},e.setMidGain=function(t){this._updateOptions({mid:Object.assign(Object.assign({},this.options.mid),{gain:t})}),this._midFilterChannel.setGain(t)},e.setHighGain=function(t){this._updateOptions({high:Object.assign(Object.assign({},this.options.high),{gain:t})}),this._highFilterNode.gain.value=t},n}(at),bt=function(t,n,e,i){return new(e||(e=Promise))((function(o,u){function r(t){try{c(i.next(t))}catch(n){u(n)}}function s(t){try{c(i.throw(t))}catch(n){u(n)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(r,s)}c((i=i.apply(t,n||[])).next())}))},wt=function(){function t(t,n){this._context=t,this._muted=!1,this._init(n)}var n=t.prototype;return n._init=function(t){return bt(this,void 0,void 0,_().mark((function n(){var e=this;return _().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this._output=new GainNode(this._context),n.next=3,new Promise((function(t,n){var i="localhost"==window.location.hostname||"127.0.0.1"==window.location.hostname;"https:"==window.location.protocol||i||n("HTTPS is required for microphone access, and this site has no SSL cert yet. Sorry!"),navigator.getUserMedia({audio:!0},(function(n){t(e._context.createMediaStreamSource(n))}),(function(t){n(t)}))}));case 3:this._input=n.sent,this._input.connect(this._output),t?this.connect(t):this.connect(this._context.destination);case 6:case"end":return n.stop()}}),n,this)})))},n.setGain=function(t){this._output.gain.value=t},n.setMuted=function(t){!0===t?this._input.disconnect(this._output):this._input.connect(this._output)},n.connect=function(t){return"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},n.disconnect=function(){return this._output.disconnect()},(0,f.Z)(t,[{key:"gain",get:function(){return this._output.gain}},{key:"muted",get:function(){return this._muted}},{key:"input",get:function(){return this._input}},{key:"output",get:function(){return this._output}}]),t}(),gt=function(t){function n(n,e){var i;return void 0===e&&(e={}),(i=t.call(this)||this)._context=n,i.params=[],i._updateOptions(Object.assign({muted:!1,envelopeType:"exponential",attackTime:10,decayTime:200,sustainValue:.25,releaseTime:1e3},e)),i}(0,m.Z)(n,t);var e=n.prototype;return e.bind=function(t,n,e){void 0===n&&(n=0),void 0===e&&(e=1),this.params.push({param:t,minValue:n,maxValue:e})},e.disconnect=function(t){this.params=this.params.filter((function(n){return n.param!==t}))},e.trigger=function(){var t=this;this.params.forEach((function(n){var e=t._context.currentTime;n.param.cancelScheduledValues(e),n.param.setValueAtTime(n.minValue,e),"exponential"===t.options.envelopeType?(n.param.exponentialRampToValueAtTime(n.maxValue,e+q(K(t.options.attackTime,0))),n.param.exponentialRampToValueAtTime(t.options.sustainValue,e+q(K(t.options.attackTime+t.options.decayTime,0)))):(n.param.linearRampToValueAtTime(n.maxValue,e+q(K(t.options.attackTime,0))),n.param.linearRampToValueAtTime(t.options.sustainValue,e+q(K(t.options.attackTime+t.options.decayTime,0))))}))},e.release=function(){var t=this;this.params.forEach((function(n){var e=t._context.currentTime;n.param.cancelScheduledValues(e),n.param.setValueAtTime(t.options.sustainValue,e),"exponential"===t.options.envelopeType?n.param.exponentialRampToValueAtTime(K(n.minValue,.01),e+q(t.options.releaseTime)):n.param.linearRampToValueAtTime(K(n.minValue,0),e+q(t.options.releaseTime))}))},e.setMuted=function(t){this._updateOptions({muted:t})},e.setEnvelopeType=function(t){this._updateOptions({envelopeType:t})},e.setAttackTime=function(t){this._updateOptions({attackTime:K(t,0)})},e.setDecayTime=function(t){this._updateOptions({decayTime:K(t,0)})},e.setSustainValue=function(t){this._updateOptions({sustainValue:K(t,0)})},e.setReleaseTime=function(t){this._updateOptions({releaseTime:K(t,0)})},n}(ct),Ct=function(t){function n(n,e){var i;return void 0===e&&(e={}),(i=t.call(this)||this)._context=n,i._voices=[],i._output=new GainNode(i._context),i._updateOptions(Object.assign({type:"square",numberOfVoices:1},e)),i}(0,m.Z)(n,t);var e=n.prototype;return e.connect=function(t){return"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},e.disconnect=function(){return this._output.disconnect()},e.play=function(t){var n=this;("number"==typeof t?[t]:t).forEach((function(t){var e=n._voices.findIndex((function(n){return n.note===t}))>=0,i=n._voices.length>=n.options.numberOfVoices;if(e||i)1===n.options.numberOfVoices&&(n._voices[0].oscillator.frequency.value=t);else{var o=new OscillatorNode(n._context);o.type=n.options.type,o.frequency.value=t,o.connect(n._output),n._voices.push({note:t,oscillator:o}),o.start()}})),console.log("PLAY this._voices : ",this._voices)},e.stop=function(t,n){var e=this;if(console.log("0"),t){console.log("1");var i=this._voices.findIndex((function(n){return n.note===t}));console.log("presentVoiceIndex : ",i),i>=0?(console.log("3"),n?(console.log("5"),setTimeout((function(){e._voices[i].oscillator.stop(),e._voices.splice(i,1)}),n)):(console.log("6"),this._voices[i].oscillator.stop(),this._voices.splice(i,1))):1===this.options.numberOfVoices&&(console.log("4"),this._voices[0].oscillator.stop(),this._voices=[])}else console.log("2"),this._voices.forEach((function(t){t.oscillator.stop()})),this._voices=[];console.log("STOP this._voices : ",this._voices)},(0,f.Z)(n,[{key:"gain",get:function(){return this._output.gain}},{key:"detune",set:function(t){this._updateOptions({detune:t}),this._voices.forEach((function(n){n.oscillator.detune.value=K(t,0,100)}))}}]),n}(ct),Et=function(t){function n(n){var e;return(e=t.call(this,n)||this)._oscillator1=new Ct(n,{type:"square",numberOfVoices:3}),e._oscillator2=new Ct(n,{type:"square",numberOfVoices:3}),e._filter=new _t(n,{}),e._filterEnvelope=new gt(n,{envelopeType:"linear",attackTime:0,decayTime:2e3,sustainValue:0,releaseTime:100}),e._amplitudeEnvelope=new gt(n),e._oscillator1.connect(e._output),e}(0,m.Z)(n,t);var e=n.prototype;return e.play=function(t){this._oscillator1.play(t)},e.stop=function(t){console.log("STOP NOTE : ",t),this._oscillator1.stop(t)},n}(pt),xt=function(t){function n(n){var e;return(e=t.call(this,n)||this)._oscillator1=new Ct(n),e._amplitudeEnvelope=new gt(n),e._filter=new _t(n,{}),e._oscillator1.connect(e._filter).connect(e._output),e}(0,m.Z)(n,t);var e=n.prototype;return e.play=function(t){this._oscillator1.play(t)},e.stop=function(){this._oscillator1.stop()},n}(pt),kt=function(t){function n(n){var e;return(e=t.call(this,n)||this)._oscillator1=new Ct(n,{type:"square",numberOfVoices:8}),e._amplitudeEnvelope=new gt(n),e._filter=new _t(n,{}),e._oscillator1.connect(e._filter).connect(e._output),e}(0,m.Z)(n,t);var e=n.prototype;return e.play=function(t){this._oscillator1.play(t)},e.stop=function(t){this._oscillator1.stop(t)},n}(pt),At=function(){},Nt=function(t,n,e,i){return new(e||(e=Promise))((function(o,u){function r(t){try{c(i.next(t))}catch(n){u(n)}}function s(t){try{c(i.throw(t))}catch(n){u(n)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(r,s)}c((i=i.apply(t,n||[])).next())}))},Ot=function(){function t(t,n,e){this._context=t,this._soundsLibrary=n,this._audioElements={},this._output=new GainNode(this._context),e?this.connect(e):this.connect(this._context.destination)}var n=t.prototype;return n.connect=function(t){return this._output.disconnect(),"input"in t&&"output"in t&&"options"in t||"input"in t&&"output"in t?(this._output.connect(t.input),t.output):this._output.connect(t)},n.setSoundVolume=function(t,n){this._audioElements[t].htmlAudioElement.volume=K(n,0,1)},n.playSound=function(t){return Nt(this,void 0,void 0,_().mark((function n(){return _().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this._audioElements[t]){n.next=3;break}return n.next=3,this._loadSound(t);case 3:"oneShotParallel"!==this._soundsLibrary[t].type&&this.stopSound(t),this._audioElements[t].htmlAudioElement.play();case 5:case"end":return n.stop()}}),n,this)})))},n.pauseSound=function(t){this._audioElements[t].htmlAudioElement.pause()},n.stopSound=function(t){this._audioElements[t].htmlAudioElement.pause(),this._audioElements[t].htmlAudioElement.currentTime=0},n._loadSound=function(t){return Nt(this,void 0,void 0,_().mark((function n(){var e,i;return _().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=this._soundsLibrary[t],n.next=3,this._handleSoundLoading(e.path);case 3:i=n.sent,this._audioElements[t]={htmlAudioElement:i,mediaElementAudioSourceNode:this._context.createMediaElementSource(i)},this._audioElements[t].htmlAudioElement.loop="loop"===e.type,this._audioElements[t].htmlAudioElement.volume=K(e.volume,0,1),this._audioElements[t].mediaElementAudioSourceNode.connect(this._output);case 8:case"end":return n.stop()}}),n,this)})))},n._handleSoundLoading=function(t){return Nt(this,void 0,void 0,_().mark((function n(){return _().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise((function(n,e){var i=new Audio(t);i.oncanplaythrough=function(){n(i)},i.onerror=function(){console.log("onerror"),e()}}));case 2:return n.abrupt("return",new Promise((function(n){var e=new Audio(t);e.oncanplaythrough=function(){n(e)}})));case 3:case"end":return n.stop()}}),n)})))},n.setGain=function(t){this._output.gain.value=t},t}(),Ft=function(t,n,e,i){return new(e||(e=Promise))((function(o,u){function r(t){try{c(i.next(t))}catch(n){u(n)}}function s(t){try{c(i.throw(t))}catch(n){u(n)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(r,s)}c((i=i.apply(t,n||[])).next())}))},Tt={AudioEngine:function(){function t(){this._masterContext=new AudioContext,this._masterChannel=new lt(this._masterContext),this._mixChannels={},this._channelStrips={},this._soundPlayers={},this._audioInputs={},this._masterChannel.output.connect(this._masterContext.destination)}var n=t.prototype;return n.getMixChannel=function(t){return this._mixChannels[t]},n.getChannelStrip=function(t){return this._channelStrips[t]},n.getSoundPlayer=function(t){return this._soundPlayers[t]},n.getAudioInput=function(t){return this._audioInputs[t]},n.getAduioInputSources=function(){return Ft(this,void 0,void 0,_().mark((function t(){return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new window.InputDeviceInfo);case 1:case"end":return t.stop()}}),t)})))},n.createAudioInput=function(t,n){return void 0===n&&(n="master"),this._audioInputs[t]=new wt(this._masterContext,this._channelToConnectNode(n)),this._audioInputs[t]},n.createSoundPlayer=function(t,n,e){return void 0===e&&(e="master"),this._soundPlayers[t]=new Ot(this._masterContext,n,this._channelToConnectNode(e)),this._soundPlayers[t]},n.createEffect=function(t,n){return void 0===n&&(n={}),"Delay"===t?new ft(this._masterContext,n):"Distortion"===t?new dt(this._masterContext,n):"Filter"===t?new _t(this._masterContext,n):"Pan"===t?new mt(this._masterContext,n):"Reverb"===t?new vt(this._masterContext,n):void 0},n.createMixChannel=function(t){return this._mixChannels[t]=new lt(this._masterContext),this._mixChannels[t].output.connect(this._masterChannel.input),this._mixChannels[t]},n.createChannelStrip=function(t,n,e){return void 0===n&&(n=[]),void 0===e&&(e="master"),console.log("createChannelStrip name",t),console.log("createChannelStrip effects",n),console.log("createChannelStrip channelName",e),this._channelStrips[t]=new ht(this._masterContext,n),this._channelStrips[t].output.connect(this._channelToConnectNode(e)),this._channelStrips[t]},n._channelToConnectNode=function(t){return console.log("_channelToConnectNode channelName",t),"master"===t?this._masterChannel.input:Object.keys(this._mixChannels).some((function(n){return n===t}))?this._mixChannels[t].input:Object.keys(this._channelStrips).some((function(n){return n===t}))?this._channelStrips[t].input:this._masterChannel.input},(0,f.Z)(t,[{key:"masterContext",get:function(){return this._masterContext}},{key:"masterChannel",get:function(){return this._masterChannel}},{key:"mixChannels",get:function(){return this._mixChannels}},{key:"channelStrips",get:function(){return this._channelStrips}},{key:"soundPlayers",get:function(){return this._soundPlayers}}]),t}(),SoundPlayer:Ot,channels:s,effects:c,envelopes:a,inputs:l,instruments:h,oscillators:p,utils:r}}}]);